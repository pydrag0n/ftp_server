<!DOCTYPE html>
<html>
<head>
    <meta name="color-scheme">
    <title>{{.CurrentPath}} - File Browser</title>

	<style>
		:root {
			--bg-light: #ffffff;
			--text-light: #222;
			--bg-dark: #1a1a1a;
			--text-dark: #e6e6e6;
			--accent: #2962ff;
			--border: rgba(0, 0, 0, 0.1);
		}

		body {
			font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, system-ui;
			max-width: 1000px;
			margin: 0 auto;
			padding: 2rem 1.5rem;
			line-height: 1.5;
		}

		body.light {
			background: var(--bg-light);
			color: var(--text-light);
			--border: rgba(0, 0, 0, 0.1);
		}

		body.dark {
			background: var(--bg-dark);
			color: var(--text-dark);
			--border: rgba(255, 255, 255, 0.1);
		}

		h1 {
			font-size: 1.8rem;
			margin: 0 0 2rem;
			font-weight: 600;
		}

		table {
			width: 100%;
			border-collapse: collapse;
			margin: 1.5rem 0;
			background: inherit;
			box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
			border-radius: 8px;
			overflow: hidden;
		}

		th, td {
			padding: 12px 15px;
			text-align: left;
			border-bottom: 1px solid var(--border);
		}

		th {
			font-weight: 600;
			background: rgba(0, 0, 0, 0.03);
		}

		tr:hover td {
			background: rgba(0, 0, 0, 0.03);
		}

		a {
			color: var(--accent);
			text-decoration: none;
		}

		a:hover {
			text-decoration: underline;
		}

		form {
			display: inline-flex;
			gap: 10px;
			margin: 0 0 1rem;
		}

		input[type="file"],
		input[type="text"],
		button {
			padding: 8px 16px;
			border-radius: 6px;
			border: 1px solid var(--border);
			font: inherit;
			transition: all 0.2s ease;
		}

		button {
			background: var(--accent);
			color: white;
			border: none;
			cursor: pointer;
			display: inline-flex;
			align-items: center;
		}

		button:hover {
			opacity: 0.9;
		}

		input[type="text"] {
			width: 200px;
			background: inherit;
			color: inherit;
		}

		img {
			width: 24px;
			height: 24px;
			vertical-align: middle;
			margin-right: 8px;
		}

		@media (max-width: 600px) {
			body {
				padding: 1rem;
			}

			th:nth-child(3),
			td:nth-child(3),
			th:nth-child(4),
			td:nth-child(4) {
				display: none;
			}
		}
			#file {
				width: 80%;
			}
			body.light {
				background-color: white;
				color: black;
			}
			body.dark {
				background-color: #1a1a1a;
				color: #e6e6e6;
			}
			body.dark a {
				color: #84c8ff;
			}
		</style>

</head>
<body class="{{.Theme}}">
	<h1>{{.CurrentPath}}</h1>
        <form action="/upload?path={{.CurrentPath}}" method="post" enctype="multipart/form-data">
            <button type="submit">Upload</button>
            <input type="file" name="file" id="file" required>
        </form>

		<form action="/createdir?path={{.CurrentPath}}" method="post">
            <button type="submit">Create</button>
			<input type="text" name="dirname" id="dirname" placeholder="Directory...">
        </form>

		<form action="/set-theme" method="POST">
			<input type="hidden" name="theme" value="{{ if eq .Theme "light" }}dark{{ else }}light{{ end }}">
			<button type="submit">Toggle theme</button>
		</form>

    <table>
        <tbody>
			<tr>
				<th></th>
				<th>Name</th>
				<th>Last Modified</th>
				<th>Size</th>
			</tr>
			<tr><th colspan="5"><hr></th></tr>
            {{ range .Files }}
            <tr>
                <td>
                    {{ if .IsDir }}
                        <img src="/static/icon/{{ $.Theme }}/folder.png" valign="top">
                    {{ else }}
                        <img src="/static/icon/{{ $.Theme }}/{{ iconForExt .Filename }}" valign="top">
                    {{ end }}
                </td>
                <td>
					<a href="/files{{ .Path }}" title="{{ .Filename }}">{{ .Filename }}{{ if .IsDir }}/{{ end }}</a>
                </td>
                <td align="right">{{ .Date }}</td>
                <td align="right">{{ if .IsDir }}-{{ else }}{{ .Size | formatSize }}{{ end }}</td>
            </tr>
            {{ end }}

        </tbody>
    </table>
</body>
</html>
